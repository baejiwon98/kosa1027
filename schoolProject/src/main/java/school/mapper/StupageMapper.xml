<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
	"-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace = "school.mapper.StupageMapper">

<update id="updatePassword" parameterType="StudentDTO">
update student set student_pw = #{studentPw} where student_id = #{studentId}
</update>

<select id="selectDepartment" resultType="MajorDTO">
select department_num departmentNum, department_name departmentName from department
</select>

<select id="autoNum" resultType="String" parameterType="String">
select extract (year from sysdate) || #{department_Num} ||(nvl(max(substr(student_num, -5)), 10000)+1) from student
where department_num = #{departmentNum}
</select>

<select id="selectOne" parameterType="String" resultType="StudentDTO">
select s.student_num studentNum, s.department_num departmentNum, d.department_name departmentName, s.student_id studentId, s.student_pw studentPw, 
s.student_name studentName, s.student_phone studentPhone, s.student_email studentEmail from student s, department d
where s.student_id = #{studentId} and s.department_num = d.department_num
</select>

<update id="stuUpdate" parameterType="StudentDTO">
update student set student_num =#{studentNum}, department_num=#{departmentNum}, student_id =#{studentId}, 
student_name =#{studentName}, student_phone =#{studentPhone}, student_email =#{studentEmail}
where student_id =#{studentId}
</update>

</mapper>